/*
 * generated by Xtext 2.28.0
 */
package game.of.life.tasks.validation;

import java.util.List;

import org.eclipse.emf.common.util.EList;
import org.eclipse.xtext.validation.Check;

import game.of.life.tasks.tASKDSL.Cell;
import game.of.life.tasks.tASKDSL.GridSize;
import game.of.life.tasks.tASKDSL.StartGrid;


/**
 * This class contains custom validation rules. 
 *
 * See https://www.eclipse.org/Xtext/documentation/303_runtime_concepts.html#validation
 */
public class TASKDSLValidator extends AbstractTASKDSLValidator {
	
//	public static val INVALID_NAME = 'invalidName'
//
//	@Check
//	def checkGreetingStartsWithCapital(Greeting greeting) {
//		if (!Character.isUpperCase(greeting.name.charAt(0))) {
//			warning('Name should start with a capital', 
//					TASKDSLPackage.Literals.GREETING__NAME,
//					INVALID_NAME)
//		}
//	}
	
	@Check 
	void checkStartGridCoordinates(GridSize gs, StartGrid sg) 
	{ 
	    Integer height = gs.getH();
	    Integer length = gs.getL();
	    Integer invalidFlag=0;
	    
	    EList<StartGrid> sglist = (EList<StartGrid>) sg.eGet(null, false); 
	    for(int i=0; i<sglist.size();i++)
	    {
	    	if((((List<StartGrid>) sg).get(i).getXC())>height || (((List<StartGrid>) sg).get(i).getXC())<0)
	    	{
	    		error("X axis out of grid",null);
	    		invalidFlag++;
	    	}
	    	if((((List<StartGrid>) sg).get(i).getYC())>length || (((List<StartGrid>) sg).get(i).getYC())<0)
	    	{
	    		error("Y axis out of grid",null);
	    		invalidFlag++;
	    	}
	    	if(invalidFlag==0)
	    	{
	    		info("X and Y axises are valid and inside the grid",null);
	    	}
	    	
	    	invalidFlag=0;
	    	
	    }
	}
	
	@Check 
	void checkCellCoordinates(GridSize gs, Cell c) 
	{ 
	    Integer height = gs.getH();
	    Integer length = gs.getL();
	    Integer invalidFlag=0;
	    
	    EList<Cell> clist = (EList<Cell>) c.eGet(null, false); 
	    for(int i=0; i<clist.size();i++)
	    {
	    	if((((List<Cell>) c).get(i).getX())>height || (((List<Cell>) c).get(i).getX())<0)
	    	{
	    		error("X axis out of grid",null);
	    		invalidFlag++;
	    	}
	    	if((((List<Cell>) c).get(i).getY())>length || (((List<Cell>) c).get(i).getY())<0)
	    	{
	    		error("Y axis out of grid",null);
	    		invalidFlag++;
	    	}
	    	if(invalidFlag==0)
	    	{
	    		info("X and Y axises are valid and inside the grid",null);
	    	}
	    	
	    	invalidFlag=0;
	    	
	    }
	}
	
	@Check 
	void checkCellStatus(Cell c) 
	{ 
	    Integer availableAction = c.getAvAction().getBirth();
	    Integer invalidFlag=0;
	    
	    EList<Cell> clist = (EList<Cell>) c.eGet(null, false); 
	    for(int i=0; i<clist.size();i++)
	    {
	    	//Cell Status=0 -> Cell is dead
	    	//Cell Status=1 -> Cell is live
	    	if (((((List<Cell>) c).get(i).getNNo())==3) && ((((List<Cell>) c).get(i).getS())==0) )  
	    	{
	    		//If Cell is dead and Neighbour No is exactly 3 -> Cell must birth
	    		if((((List<Cell>) c).get(i).getAvAction().getBirth())!=1)
	    		{
		    		error("Item's next available action is birth!",null);
		    		invalidFlag++;
	    		}
	    		if((((List<Cell>) c).get(i).getAvAction().getOvercrowd())==1)
	    		{
		    		error("Death by Overcrowing is not available for this item ! Try changing to birth!",null);
		    		invalidFlag++;
	    		}
	    		if((((List<Cell>) c).get(i).getAvAction().getSur())==1)
	    		{
		    		error("Survival is not available for this item ! Try changing to birth!",null);
		    		invalidFlag++;
	    		}
	    		if((((List<Cell>) c).get(i).getAvAction().getXiso())==1)
	    		{
		    		error("Death by Isolation is not available for this item ! Try changing to birth!",null);
		    		invalidFlag++;
	    		}
	    	}
	    	
	    	if((((List<Cell>) c).get(i).getNNo())<1) //Cell must die because of isolation
	    	{
	    		if((((List<Cell>) c).get(i).getAvAction().getXiso())!=1)
	    		{
		    		error("Item's next available action is death by isolation!",null);
		    		invalidFlag++;
	    		}
	    		if((((List<Cell>) c).get(i).getAvAction().getOvercrowd())==1)
	    		{
		    		error("Death by Overcrowing is not available for this item ! Try changing to death by isolation!",null);
		    		invalidFlag++;
	    		}
	    		if((((List<Cell>) c).get(i).getAvAction().getSur())==1)
	    		{
		    		error("Survival is not available for this item ! Try changing to death by isolation!",null);
		    		invalidFlag++;
	    		}
	    		if((((List<Cell>) c).get(i).getAvAction().getBirth())==1)
	    		{
		    		error("Birth is not available for this item ! Try changing to death by isolation!",null);
		    		invalidFlag++;
	    		}
	    	}
	    	
	    	if((((List<Cell>) c).get(i).getNNo())>4) //Cell must die because of overcrowding
	    	{
	    		if((((List<Cell>) c).get(i).getAvAction().getOvercrowd())!=1)
	    		{
		    		error("Item's next available action is death by overcrowding!",null);
		    		invalidFlag++;
	    		}
	    		if((((List<Cell>) c).get(i).getAvAction().getXiso())==1)
	    		{
		    		error("Death by isolation is not available for this item ! Try changing to death by overcrowding!",null);
		    		invalidFlag++;
	    		}
	    		if((((List<Cell>) c).get(i).getAvAction().getSur())==1)
	    		{
		    		error("Survival is not available for this item ! Try changing to death by overcrowding!",null);
		    		invalidFlag++;
	    		}
	    		if((((List<Cell>) c).get(i).getAvAction().getBirth())==1)
	    		{
		    		error("Birth is not available for this item ! Try changing to death by overcrowding!",null);
		    		invalidFlag++;
	    		}
	    	}
	    	if(((((List<Cell>) c).get(i).getNNo())==2) || ((((List<Cell>) c).get(i).getNNo())==3)) //Cell must survive
	    	{
	    		if((((List<Cell>) c).get(i).getAvAction().getSur())!=1)
	    		{
		    		error("Item's next available action is survival!",null);
		    		invalidFlag++;
	    		}
	    		if((((List<Cell>) c).get(i).getAvAction().getXiso())==1)
	    		{
		    		error("Death by isolation is not available for this item ! Try changing to survival!",null);
		    		invalidFlag++;
	    		}
	    		if((((List<Cell>) c).get(i).getAvAction().getOvercrowd())==1)
	    		{
		    		error("Death by overcrowding is not available for this item ! Try changing to survival!",null);
		    		invalidFlag++;
	    		}
	    		if((((List<Cell>) c).get(i).getAvAction().getBirth())==1)
	    		{
		    		error("Birth is not available for this item ! Try changing to survival!",null);
		    		invalidFlag++;
	    		}
	    	}
	    	
	    	if(invalidFlag==0)
	    	{
	    		info("Item's next action is correctly identified",null);
	    	}
	    	
	    	invalidFlag=0;
	    	
	    }
	}
}

